<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>ATS Tutorial Tools</title>
  <style type="text/css">code{white-space: pre-wrap;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>

<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css"> -->
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/typeplate-starter-kit/3.0.2/css/typeplate.min.css"> -->



  <script src="https://ats-lang.github.io/LIBRARY/libatscc2js/libatscc2js_all.js"></script>
  <script src="https://ats-lang.github.io/LIBRARY/libatscc2js/libatscc2js_print_store_cats.js"></script>
  <script src="https://ats-lang.github.io/LIBRARY/ats2langweb/pats2xhtmlize_dats.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/styles/solarized-light.min.css">
  <script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.4/ace.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/highlight.min.js"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.3/css/bootstrap.min.css" integrity="sha384-MIwDKRSSImVFAZCVLtU0LMDdON6KVCrZHyVQQj6e8wIEJkW4tvwqXrbMIya1vriY" crossorigin="anonymous">

<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"> -->



</head>

<body>
<br>
<div class="container">

<div class="row">
  <section class="header col-md-3 pull-md-left" style="position:fixed">
            <header>
    <h1 class="title">ATS Tutorial Tools</h1>
                </header>
    
    <section class="toc">
        <nav id="TOC">
    <ul>
    <li><a href="#ats-tutorials-tooling-support">ATS Tutorials Tooling Support</a><ul>
    <li><a href="#contribution">Contribution</a></li>
    <li><a href="#installation">Installation</a></li>
    <li><a href="#getting-start">Getting Start</a></li>
    <li><a href="#using-code-blocks">Using Code Blocks</a></li>
    <li><a href="#other-options">Other Options</a></li>
    </ul></li>
    </ul>
    </nav>
        </section>
  </section>

  <section class="main col-md-9 offset-md-3">
<script>// Generated by CoffeeScript 1.10.0
(function() {
  var ats_service;

  ats_service = {
    hljs: false,
    precodify: function(str, pre_cls, code_cls) {
      if (pre_cls == null) {
        pre_cls = "";
      }
      if (code_cls == null) {
        code_cls = "";
      }
      return "<pre class=\"" + pre_cls + "\"><code class=\"" + code_cls + "\">" + str + "</code></pre>";
    },
    api: {
      tc: "https://www.ats-lang.org/SERVER/MYCODE/atslangweb_patsopt_tcats_0_.php",
      cc: "https://www.ats-lang.org/SERVER/MYCODE/atslangweb_patsopt_ccats_0_.php",
      cjs: "https://www.ats-lang.org/SERVER/MYCODE/atslangweb_patsopt_atscc2js_0_.php",
      chtml: "https://www.ats-lang.org/SERVER/MYCODE/atslangweb_pats2xhtml_eval_0_.php"
    },
    get_code: function(id) {
      return ace.edit(id + "-editor").getValue();
    },
    fix_pre_code: function(elem) {
      var classes;
      classes = $(elem).attr("class");
      elem = $(elem).wrapAll("<pre><code></code></pre>").children().unwrap().parent().parent();
      elem.attr("class", classes);
      return elem;
    },
    use_hljs: function(elem) {
      var fn, k, mapping, v;
      elem = this.fix_pre_code(elem);
      elem.addClass("hljs").removeClass("patsyntax");
      mapping = {
        'keyword': 'hljs-keyword',
        'comment': 'hljs-comment',
        'extcode': 'hljs-meta',
        'neuexp': '',
        'staexp': 'hljs-type',
        'prfexp': 'hljs-symbol',
        'dynexp': '',
        'stalab': 'hljs-type',
        'dynlab': '',
        'dynstr': 'hljs-string',
        'stacstdec': '',
        'stacstuse': '',
        'dyncstdec': '',
        'dyncstuse': '',
        'dyncst_implement': ''
      };
      fn = function(k, v) {
        return elem.find("." + k).removeClass(k).addClass(v);
      };
      for (k in mapping) {
        v = mapping[k];
        fn(k, v);
      }
      return elem;
    },
    preview: function(id) {
      var handler, self;
      $("#" + id + " button:contains('Edit')").show();
      $("#" + id + " button:contains('Preview')").hide();
      $("#" + id + " > .preview").show();
      $("#" + id + " > .editor").hide();
      self = this;
      handler = function(data, status) {
        var html;
        data = $.parseJSON(decodeURIComponent(data));
        html = self.hljs ? self.use_hljs(data[1]) : self.fix_pre_code(data[1]);
        return $("#" + id + "-preview").html(html);
      };
      return $.post(this.api.chtml, {
        mycode: this.get_code(id),
        stadyn: 1
      }).done(handler);
    },
    show_code: function(id, code, language, append) {
      var target;
      if (append == null) {
        append = false;
      }
      if (!append) {
        this.clear();
      }
      if (this.hljs) {
        code = hljs.highlight(language, code).value;
      }
      code = this.hljs ? this.precodify(code, "hljs") : this.precodify(code);
      target = $("#" + id + "-output");
      if (append && target.html().length > 0) {
        target.append("<br>");
        return target.append(code);
      } else {
        return target.html(code);
      }
    },
    edit: function(id) {
      $("#" + id + " button:contains('Edit')").hide();
      $("#" + id + " button:contains('Preview')").show();
      $("#" + id + " > .preview").hide();
      return $("#" + id + " > .editor").show();
    },
    typecheck: function(id) {
      var handler, self;
      self = this;
      handler = function(data, status) {
        data = $.parseJSON(decodeURIComponent(data));
        console.log(status);
        return self.show_code(id, data[1], "bash");
      };
      return $.post(this.api.tc, {
        mycode: this.get_code(id),
        stadyn: 1
      }).done(handler);
    },
    compilec: function(id) {
      var handler, self;
      self = this;
      handler = function(data, status) {
        data = $.parseJSON(decodeURIComponent(data));
        if (data[0] === 0) {
          return self.show_code(id, data[1], "c");
        } else {
          return self.show_code(id, data[1], "bash");
        }
      };
      return $.post(this.api.cc, {
        mycode: this.get_code(id),
        stadyn: 1
      }).done(handler);
    },
    runjs: function(id) {
      var handler, self;
      self = this;
      handler = function(data, status) {
        var error, error1, result;
        data = $.parseJSON(decodeURIComponent(data));
        if (!data[0] === 0) {
          return self.show_code(id, data[1], "bash");
        } else {
          try {
            result = eval(data[1]);
            return self.show_code(id, result, "js");
          } catch (error1) {
            error = error1;
            return $("#" + id + "-output").html("" + error);
          } finally {
            self.show_code(id, data[1], "js", true);
          }
        }
      };
      return $.post(this.api.cjs, {
        mycode: this.get_code(id),
        stadyn: 1
      }).done(handler);
    },
    download: function(id) {
      var code;
      code = escape(this.get_code(id));
      return window.open("data:x-application/text," + code);
    },
    clear: function(id) {
      return $("#" + id + "-output").empty();
    }
  };

  window.ats_service = ats_service;

}).call(this);
</script>
<style>.editable > .editor {width: 100%; min-height: 100px; font-size: 12px}</style>
<script>window.ats_service.hljs = true</script>
<h1 id="ats-tutorials-tooling-support">ATS Tutorials Tooling Support</h1>
<p>Our toolset provides you with a plugin and supporting files on top of a regular <code>pandoc</code> workflow: writing markdown, and getting webpages. You gain all the benefits of markdown and all the power of <code>pandoc</code>, and you can easily wirte ATS programming language tutorials that embeds editable/runnable ATS code with proper highlighting.</p>
<p>All the tools you need is in the released <code>lib</code> folder. It contains</p>
<ul>
<li>a python filter <code>ats_tutorialize.py</code> for <code>pandoc</code>, which processes incoming <code>pandoc</code> parse tree, and transform it in some way to produce interactive tutorials.<br />
</li>
<li>a template <code>ats_template.html</code></li>
<li>a javascript file <code>ats_service.js</code> (compiled from coffeescript) that provides the interactive part of the webpage.</li>
<li>several stylesheets</li>
<li>and an example with proper makefile.</li>
</ul>
<p>Before we can start, we need to ensure that we have the following software installed.</p>
<ul>
<li>python3, pip3, and <a href="http://docs.python-guide.org/en/latest/dev/virtualenvs/">virtualenv</a></li>
<li><a href="http://pandoc.org/">pandoc (latest)</a></li>
</ul>
<h2 id="contribution">Contribution</h2>
<p>Please head to <a href="https://github.com/steinwaywhw/ats-tutorials" class="uri">https://github.com/steinwaywhw/ats-tutorials</a>. Issues, pull requests are welcomed.</p>
<h2 id="installation">Installation</h2>
<p>Installation is easy, just download the <a href="release.tar.gz" class="uri">release.tar.gz</a>, and install necessary softwares. Requested python packages can be setup by the following steps.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">make</span> -f example.make setup_venv <span class="co"># setup virtual env and install python packages</span>
<span class="kw">source</span> .venv/bin/activate       <span class="co"># enter the virtual env</span></code></pre></div>
<p>Then you can start working on the tutorials. After finished, remeber to deactivate the virtual environment by</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">deactivate</span></code></pre></div>
<h2 id="getting-start">Getting Start</h2>
<p>With <code>example.make</code> and <code>example.md</code>, we just type</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">make</span> -f example.make </code></pre></div>
<p>and the output will be in <code>example.md</code>. This example file mainly demonstrats how a regular markdown file looks like, with features like * YAML front matter, where you can configure the behavior of both <code>pandoc</code> and our filter. For <code>pandoc</code> parameters, see <a href="http://pandoc.org/MANUAL.html">its user guide</a>. * basic formattings of elements, e.g. headings, paragraghs, lists, inline code, etc. See <code>pandoc</code> <a href="http://pandoc.org/MANUAL.html">user guide</a> for full references. See <a href="https://daringfireball.net/projects/markdown/">here</a> for a quick look. * fenced code blocks with options, see followings for details. The code blocks with <code>.ats</code> option will be processed by our filter. Others will be processed by <code>pandoc</code> as usual.</p>
<h2 id="using-code-blocks">Using Code Blocks</h2>
<p>Let's take a fully equipped example as follows.</p>
<pre><code>    ```{#assignment1 .ats .dynamic}
    extern fun hello (): string 
    implement main0 () = ()
    ```</code></pre>
<pre class="hljs" id="assignment1"><code><span class="hljs-keyword">extern</span> <span class=""><span class="hljs-keyword">fun</span> hello <span class="hljs-keyword">(</span><span class="hljs-keyword">)</span><span class="hljs-keyword">:</span> <span class="hljs-type">string</span></span> 
<span class=""><span class="hljs-keyword">implement</span> main0 <span class="hljs-keyword">(</span><span class="hljs-keyword">)</span> <span class="hljs-keyword">=</span> <span class="hljs-keyword">(</span><span class="hljs-keyword">)</span></span>
</code></pre>
<p>Here, after the opening fence, a curly brace is used to provide options. <code>#assignment1</code> is the id of this code block, which will be the id of corresponding html element in the output. <code>.ats</code> and <code>.dynamic</code> are classes of the code, specifying that this is dynamic ATS code that needs to be highlighted. You can add more classes, they will be passed unchanged to the resulting html elements as their classes. If you are writing static ATS code, just change <code>.dynamic</code> to <code>.static</code>.</p>
<p>If you have a longer file, that you don't want to compose in-place, use the option <code>include=file.ext</code> as below.</p>
<pre><code>    ```{#assignment1 .ats .dynamic include=&quot;example.dats&quot;}
    ```</code></pre>
<pre class="hljs" id="assignment1"><code><span class="hljs-keyword">extern</span> <span class=""><span class="hljs-keyword">fun</span> hello <span class="hljs-keyword">(</span><span class="hljs-keyword">)</span><span class="hljs-keyword">:</span> <span class="hljs-type">string</span></span>
<span class=""><span class="hljs-keyword">implement</span> hello <span class="hljs-keyword">(</span><span class="hljs-keyword">)</span> <span class="hljs-keyword">=</span> <span class="hljs-string">"world"</span></span>

<span class=""><span class="hljs-keyword">implement</span> main0 <span class="hljs-keyword">(</span><span class="hljs-keyword">)</span> <span class="hljs-keyword">=</span> <span class="hljs-keyword">(</span><span class="hljs-keyword">)</span> <span class="hljs-keyword">where</span> <span class="hljs-keyword">{</span>
	<span class=""><span class="hljs-keyword">val</span> _ <span class="hljs-keyword">=</span> <span class="">println!</span> <span class="hljs-keyword">(</span>hello <span class="hljs-keyword">(</span><span class="hljs-keyword">)</span><span class="hljs-keyword">)</span></span>
<span class="hljs-keyword">}</span></span>
</code></pre>
<p>If you want the code to be editable, just add <code>.editable</code> as below.</p>
<pre><code>    ```{#assignment1 .ats .dynamic .editable include=&quot;example.dats&quot;}
    ```</code></pre>

<section class="ats dynamic editable" id="assignment1">
<div class="control" id="assignment1-control">
<button onclick='ats_service.preview("assignment1")'>Preview</button>
<button onclick='ats_service.edit("assignment1")'>Edit</button>
<button onclick='ats_service.download("assignment1")'>Download</button>
<button onclick='ats_service.clear("assignment1")'>Clear Output</button>
<button onclick='ats_service.typecheck("assignment1")'>Type Check</button>
<button onclick='ats_service.compilec("assignment1")'>Compile (C)</button>
<button onclick='ats_service.runjs("assignment1")'>Run (JavaScript)</button>
</div>
<div class="editor" id="assignment1-editor">extern fun hello (): string
implement hello () = "world"

implement main0 () = () where {
	val _ = println! (hello ())
}</div>
<div class="preview" id="assignment1-preview"></div>
<div class="output" id="assignment1-output"></div>
<script>
		  	  var editor = ace.edit("assignment1-editor");
		  	  editor.$blockScrolling = Infinity;
		  	  editor.setTheme("ace/theme/solarized_dark");
		  	  editor.setOptions({maxLines: Infinity});
		  	  editor.session.setMode("ace/mode/plain_text");
		  	  editor.resize();
		  	  ats_service.edit("assignment1");
		  	</script>
</section>

<p>The resulting page will provide a group of buttons, for editing the code, as well as type-checking, compiling to c, and compiling to javascript.</p>
<h2 id="other-options">Other Options</h2>
<p>As you can see, in the YAML front matter (the beginning of the raw content of this markdown file), we have several options to set. They are as follows.</p>
<ul>
<li><code>hljs</code>: use <code>highlight.js</code> if set to true. use default styling if <code>false</code>. <code>true</code> by default.</li>
<li><code>hljs-style</code>: choose a theme for <code>highlight.js</code>, see <a href="https://github.com/isagalaev/highlight.js/tree/master/src/styles">github</a> for a complete list of styles.</li>
<li><code>ace-style</code>: choose a theme for the <code>ace</code> editor, see <a href="https://github.com/ajaxorg/ace/tree/master/lib/ace/theme">github</a> for a complete list. Default to <code>solarized_dark</code>.</li>
<li><code>title</code>: Title of the document. This is part of the options provided by <code>pandoc</code>, see the <code>ats_template.html</code> for a full list of options. Just look for template variables enclosed in <code>$</code>.</li>
</ul>  
  </section>
</div>
  
<div class="row">
  <section class="footer col-md-9 offset-md-3 m-b-3">
    <hr>

    
    Copyright Notice 
  </section>
</div>

</div>

<script>
  $("button").addClass("btn btn-outline-primary btn-sm");
  $(".toc > nav ul").addClass("nav");
  $(".toc > nav ul li").addClass("nav-item");
  $(".toc > nav ul a").addClass("nav-link");
  $(".editable .control").addClass("m-b-1");
  $(".editable .output").addClass("m-t-1");
</script>
</body>
</html>
